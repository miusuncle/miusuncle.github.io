{"version":3,"sources":["data/courses lazy /^/.//.*/.json$/ groupOptions: {} namespace object","utils/event.js","utils/localStore.js","hooks/useDocumentTitle.js","configs/env.js","components/Loading.jsx","configs/pbr.js","components/MediaStateProvider.jsx","components/TitleBar/ThemeToggler.jsx","components/TitleBar/PlaybackRateSwitch.jsx","components/TitleBar/TitleBar.jsx","routes/index/CourseList/CourseCard.jsx","routes/index/CourseList/CourseList.jsx","routes/index/IndexPage.jsx","routes/detail/MessageHeading.jsx","routes/detail/MessageList/ImageCard.jsx","routes/detail/MessageList/AudioCard.jsx","routes/detail/MessageList/TextCard.jsx","routes/detail/MessageList/PDFCard.jsx","routes/detail/MessageList/VideoCard.jsx","routes/detail/MessageList/MessageList.jsx","routes/detail/DetailPage.jsx","App.jsx","hooks/useTheme.js","index.jsx","lib/index.js","lib/dateFormat.js","lib/entity.js","lib/marked.js","lib/moment.js","lib/prettyBytes.js"],"names":["map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","t","keys","Object","module","exports","EE","EventEmitter","localStore","key","JSON","parse","localStorage","getItem","err","value","setItem","stringify","require","useRef","useEffect","useDocumentTitle","title","retainOnUnmount","defaultTitle","document","current","DEFAULT_TITLE","courseCollection","createEntityCollection","courseList","x","String","indexPageVisited","useStyles","makeStyles","theme","loading","Loading","classes","className","CircularProgress","PLAYBACK_RATE_STORED_KEY","playbackRateCollection","text","mediaReducer","state","action","type","payload","playbackRate","playingMediaId","MediaStateContext","createContext","intialState","useMediaState","useContext","MediaStateProvider","children","Provider","useReducer","ThemeToggler","useTheme","IconButton","edge","color","onClick","emit","palette","PlaybackRateSwitch","useState","open","setOpen","mediaState","dispathMediaAction","updatePlaybackRate","useCallback","listItems","useMemo","playbackRateEntityList","convertToEntityList","List","component","subheader","ListSubheader","pbr","selected","ListItem","button","ListItemText","primary","ListItemIcon","useMount","list","includes","Number","Drawer","anchor","variant","onClose","toolbar","paddingLeft","spacing","paddingRight","icon","marginRight","flexGrow","mainTitle","fontWeight","subTitle","verticalAlign","offset","mixins","TitleBar","course","back","history","useHistory","trigger","useScrollTrigger","disableHysteresis","threshold","revealCourseBrief","AppBar","position","elevation","Toolbar","disableRipple","goBack","replace","Typography","display","noWrap","Boolean","description","filter","join","margin","CourseCard","start","dateFormat","started_at","duration","moment","finished_at","diff","asMinutes","Card","CardActionArea","push","CardContent","Grid","container","wrap","item","Avatar","src","speakers","avatar_url","imgProps","referrerPolicy","xs","zeroMinWidth","Math","ceil","Divider","direction","alignItems","fontSize","full_name","root","paddingTop","paddingBottom","CourseList","courseEntityList","sm","IndexPage","Container","maxWidth","heading","MessageHeading","ImageCard","message","imgRef","io","IntersectionObserver","entry","isIntersecting","image","target","dataset","unobserve","observe","disconnect","CardMedia","ref","style","width","minHeight","data-src","attachment","url","buffer","left","top","bottom","transition","opacity","background","secondary","main","progress","right","lineHeight","AudioCard","playStatus","setPlayStatus","setPosition","setDuration","bufferPercent","setBufferPercent","progressPercent","readableDuration","remain","md","parts","minutes","seconds","hours","unshift","padStart","updatePlayStatus","newPlayStatus","fastRewind","newProgressPercent","max","fastForward","min","useUpdateEffect","playNextAudio","on","off","CardActions","size","disableShrink","autoLoad","loop","onLoading","bytesLoaded","bytesTotal","dur","onPlaying","onFinishedPlaying","onError","errorCode","console","log","content","TextCard","html","renderer","marked","Renderer","link","href","renderToStaticMarkup","Link","gfm","mangle","dangerouslySetInnerHTML","__html","PDFCard","window","name","prettyBytes","VideoCard","MessageList","messageList","knownMessgeList","category","mime_type","audioMessageList","requestNextPlayingMediaId","currentIndex","findIndex","length","nextPlayingMediaId","message_id","courseEntities","entities","DetailPage","courseId","useParams","fetchStatus","setFetchStatus","setMessageList","a","default","fetchCourseMessages","to","App","getNextTheme","paletteMode","orange","grey","setTheme","toggleTheme","ThemeProvider","createMuiTheme","CssBaseline","strict","exact","path","ReactDOM","render","getElementById","entityList","keySelector","reduce","ret","collection"],"mappings":"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","file":"static/js/main.c8356fed.chunk.js","sourcesContent":["var map = {\n\t\"./2192.json\": [\n\t\t129,\n\t\t3\n\t],\n\t\"./2195.json\": [\n\t\t130,\n\t\t4\n\t],\n\t\"./2227.json\": [\n\t\t131,\n\t\t5\n\t],\n\t\"./2270.json\": [\n\t\t132,\n\t\t6\n\t],\n\t\"./2322.json\": [\n\t\t133,\n\t\t7\n\t],\n\t\"./2367.json\": [\n\t\t134,\n\t\t8\n\t],\n\t\"./2415.json\": [\n\t\t135,\n\t\t9\n\t],\n\t\"./2454.json\": [\n\t\t136,\n\t\t10\n\t],\n\t\"./2460.json\": [\n\t\t137,\n\t\t11\n\t],\n\t\"./2503.json\": [\n\t\t138,\n\t\t12\n\t],\n\t\"./2520.json\": [\n\t\t139,\n\t\t13\n\t],\n\t\"./2545.json\": [\n\t\t140,\n\t\t14\n\t],\n\t\"./2584.json\": [\n\t\t141,\n\t\t15\n\t],\n\t\"./2624.json\": [\n\t\t142,\n\t\t16\n\t],\n\t\"./2644.json\": [\n\t\t143,\n\t\t17\n\t],\n\t\"./2654.json\": [\n\t\t144,\n\t\t18\n\t],\n\t\"./2676.json\": [\n\t\t145,\n\t\t19\n\t],\n\t\"./2695.json\": [\n\t\t146,\n\t\t20\n\t],\n\t\"./2709.json\": [\n\t\t147,\n\t\t21\n\t],\n\t\"./2732.json\": [\n\t\t148,\n\t\t22\n\t],\n\t\"./2769.json\": [\n\t\t149,\n\t\t23\n\t],\n\t\"./2790.json\": [\n\t\t150,\n\t\t24\n\t],\n\t\"./2801.json\": [\n\t\t151,\n\t\t25\n\t],\n\t\"./2821.json\": [\n\t\t152,\n\t\t26\n\t],\n\t\"./2860.json\": [\n\t\t153,\n\t\t27\n\t],\n\t\"./2903.json\": [\n\t\t154,\n\t\t28\n\t],\n\t\"./2967.json\": [\n\t\t155,\n\t\t29\n\t],\n\t\"./3013.json\": [\n\t\t156,\n\t\t30\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 3);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 124;\nmodule.exports = webpackAsyncContext;","import EventEmitter from 'eventemitter3';\n\nexport { EventEmitter };\nexport const EE = new EventEmitter();\n","export const localStore = {\n  /**\n   * @param {string} key\n   */\n  get(key) {\n    try {\n      return JSON.parse(localStorage.getItem(key));\n    } catch (err) {\n      return undefined;\n    }\n  },\n\n  /**\n   * @param {string} key\n   * @param {any} value\n   */\n  set(key, value) {\n    try {\n      localStorage.setItem(key, JSON.stringify(value));\n      return true;\n    } catch (err) {\n      return false;\n    }\n  },\n\n  /**\n   * @param {string} key\n   */\n  del(key) {\n    try {\n      localStorage.removeItem(key);\n      return true;\n    } catch (err) {\n      return false;\n    }\n  },\n\n  isSupport() {\n    try {\n      const whatever = 'whatever';\n      localStorage.setItem(whatever, whatever);\n      localStorage.removeItem(whatever);\n      return true;\n    } catch (err) {\n      return false;\n    }\n  },\n};\n","const { useRef, useEffect } = require('react');\n\n/**\n * @param {string} title 文档标题\n * @param {boolean} [retainOnUnmount] 页面卸载后保留标题？\n */\nexport function useDocumentTitle(title, retainOnUnmount = false) {\n  const defaultTitle = useRef(document.title);\n\n  useEffect(() => {\n    document.title = title;\n  }, [title]);\n\n  useEffect(() => {\n    const title = defaultTitle.current;\n    return () => {\n      if (!retainOnUnmount) {\n        document.title = title;\n      }\n    };\n  }, [retainOnUnmount]);\n}\n","import courseList from '@src/data/index.json';\nimport { createEntityCollection } from '@src/lib';\n\nexport const DEFAULT_TITLE = '笑来写作课';\n\n/** @type {EntityCollection<CourseEntity>} */\nexport const courseCollection = createEntityCollection(courseList, x => String(x.id));\n\n/** 是否已访问首页 */\nexport let indexPageVisited = false;\n\nexport const markIndexPageAsVisted = () => {\n  indexPageVisited = true;\n};\n","import { makeStyles } from '@material-ui/core/styles';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\nconst useStyles = makeStyles(theme => ({\n  loading: {\n    'display': 'flex',\n    'justify-content': 'center',\n    'margin': '100px 0',\n  },\n}));\n\nexport function Loading() {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.loading}>\n      <CircularProgress />\n    </div>\n  );\n}\n","import { createEntityCollection } from '@src/lib';\n\n/** `localStorage` key */\nexport const PLAYBACK_RATE_STORED_KEY = 'xow-pbr';\n\nexport const playbackRateCollection = createEntityCollection(\n  [\n    { text: '2.0x', value: 2 },\n    { text: '1.5x', value: 1.5 },\n    { text: '1.25x', value: 1.25 },\n    { text: '正常倍速', value: 1 },\n    { text: '0.75x', value: 0.75 },\n  ],\n  x => String(x.value),\n);\n","import React, { createContext, useReducer, useContext } from 'react';\nimport { localStore } from '@src/utils';\nimport { PLAYBACK_RATE_STORED_KEY } from '@src/configs/pbr';\n\n/**\n * @param {MediaState} state\n * @param {MediaAction} action\n */\nconst mediaReducer = (state, action) => {\n  const { type, payload } = action;\n\n  switch (type) {\n    case 'updatePlaybackRate': {\n      const playbackRate = payload['value'];\n      localStore.set(PLAYBACK_RATE_STORED_KEY, playbackRate);\n      return { ...state, playbackRate };\n    }\n\n    case 'switchPlayingMediaId': {\n      return { ...state, playingMediaId: payload['id'] || null };\n    }\n\n    default:\n      return state;\n  }\n};\n\nconst MediaStateContext = createContext(null);\n\n/** @type {MediaState} */\nconst intialState = {\n  playbackRate: 1,\n  playingMediaId: null,\n};\n\n/**\n * @type {() => [MediaState, React.Dispatch<MediaAction>]}\n */\nexport const useMediaState = () => useContext(MediaStateContext);\n\nexport function MediaStateProvider({ children }) {\n  return (\n    <MediaStateContext.Provider value={useReducer(mediaReducer, intialState)}>\n      {children}\n    </MediaStateContext.Provider>\n  );\n}\n","import { useTheme } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\nimport Brightness7Icon from '@material-ui/icons/Brightness7';\nimport Brightness4Icon from '@material-ui/icons/Brightness4';\nimport { EE } from '@src/utils';\n\nexport function ThemeToggler() {\n  const theme = useTheme();\n\n  return (\n    <IconButton\n      edge=\"start\"\n      color=\"inherit\"\n      onClick={() => {\n        EE.emit('toggle-theme');\n      }}\n    >\n      {theme.palette.type === 'light' ? <Brightness4Icon /> : <Brightness7Icon />}\n    </IconButton>\n  );\n}\n","import { useCallback, useMemo, useState } from 'react';\nimport { useMount } from 'react-use';\nimport Drawer from '@material-ui/core/Drawer';\nimport IconButton from '@material-ui/core/IconButton';\nimport SlowMotionVideoIcon from '@material-ui/icons/SlowMotionVideo';\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\nimport { convertToEntityList } from '@src/lib';\nimport { PLAYBACK_RATE_STORED_KEY, playbackRateCollection } from '@src/configs/pbr';\nimport { useMediaState } from '@src/components';\nimport { localStore } from '@src/utils';\n\nexport function PlaybackRateSwitch() {\n  const [open, setOpen] = useState(false);\n  const [mediaState, dispathMediaAction] = useMediaState();\n\n  const updatePlaybackRate = useCallback(\n    (/** @type {number} */ playbackRate) => {\n      dispathMediaAction({\n        type: 'updatePlaybackRate',\n        payload: { value: playbackRate },\n      });\n    },\n    [dispathMediaAction],\n  );\n\n  const listItems = useMemo(() => {\n    const playbackRateEntityList = convertToEntityList(playbackRateCollection);\n\n    return (\n      <List\n        component=\"nav\"\n        subheader={<ListSubheader component=\"div\">{'音频播放倍速'}</ListSubheader>}\n      >\n        {playbackRateEntityList.map(pbr => {\n          const selected = pbr.value === mediaState.playbackRate;\n\n          return (\n            <ListItem\n              key={pbr.value}\n              button\n              selected={selected}\n              onClick={() => {\n                updatePlaybackRate(pbr.value);\n                setOpen(false);\n              }}\n            >\n              <ListItemText primary={pbr.text} />\n              <ListItemIcon>\n                <CheckCircleIcon color={selected ? 'primary' : 'disabled'} />\n              </ListItemIcon>\n            </ListItem>\n          );\n        })}\n      </List>\n    );\n  }, [mediaState, updatePlaybackRate]);\n\n  useMount(() => {\n    // init `playbackRate`\n    let playbackRate = localStore.get(PLAYBACK_RATE_STORED_KEY);\n    if (!playbackRateCollection.list.includes(String(playbackRate))) {\n      playbackRate = 1;\n    }\n    updatePlaybackRate(Number(playbackRate));\n  });\n\n  return (\n    <>\n      <IconButton\n        edge=\"start\"\n        color=\"inherit\"\n        onClick={() => {\n          setOpen(true);\n        }}\n      >\n        <SlowMotionVideoIcon />\n      </IconButton>\n      <Drawer anchor=\"bottom\" variant=\"temporary\" open={open} onClose={() => setOpen(false)}>\n        {listItems}\n      </Drawer>\n    </>\n  );\n}\n","import { useHistory } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport BorderColorIcon from '@material-ui/icons/BorderColor';\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\nimport useScrollTrigger from '@material-ui/core/useScrollTrigger';\nimport { indexPageVisited } from '@src/configs/env';\nimport { ThemeToggler } from './ThemeToggler';\nimport { PlaybackRateSwitch } from './PlaybackRateSwitch';\n\nconst useStyles = makeStyles(theme => ({\n  toolbar: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1),\n  },\n  icon: {\n    marginRight: theme.spacing(1),\n  },\n  title: {\n    flexGrow: 1,\n  },\n  mainTitle: {\n    fontWeight: 'bold',\n  },\n  subTitle: {\n    verticalAlign: 'top',\n  },\n  offset: theme.mixins.toolbar,\n}));\n\n/**\n * @param {object} props\n * @param {string} props.title 标题\n * @param {CourseEntity} [props.course] 课程对象\n * @param {boolean} [props.back] 是否返回？\n */\nexport function TitleBar({ title, course, back }) {\n  const history = useHistory();\n  const classes = useStyles();\n\n  const trigger = useScrollTrigger({\n    disableHysteresis: true,\n    threshold: 0,\n  });\n\n  const revealCourseBrief = useScrollTrigger({\n    disableHysteresis: true,\n    threshold: 80,\n  });\n\n  return (\n    <>\n      <AppBar position=\"fixed\" elevation={trigger ? 4 : 0}>\n        <Toolbar variant=\"regular\" className={classes.toolbar}>\n          {!back && (\n            <IconButton color=\"inherit\" className={classes.icon} disableRipple>\n              <BorderColorIcon />\n            </IconButton>\n          )}\n          {back && (\n            <IconButton\n              color=\"inherit\"\n              className={classes.icon}\n              onClick={() => {\n                if (indexPageVisited) {\n                  history.goBack();\n                } else {\n                  history.replace('/');\n                }\n              }}\n            >\n              <ArrowBackIcon />\n            </IconButton>\n          )}\n          <Typography variant=\"inherit\" display=\"block\" noWrap className={classes.title}>\n            <Typography variant=\"h6\" color=\"inherit\" className={classes.mainTitle}>\n              {title}\n            </Typography>\n            {Boolean(revealCourseBrief && course) && (\n              <Typography variant={'caption'} color=\"inherit\" className={classes.subTitle}>\n                {[course.title, course.description].filter(Boolean).join(' · ')}\n              </Typography>\n            )}\n          </Typography>\n\n          {Boolean(course) && <PlaybackRateSwitch />}\n          <ThemeToggler />\n        </Toolbar>\n      </AppBar>\n\n      {/* @see https://material-ui.com/components/app-bar/#fixed-placement */}\n      <div className={classes.offset} />\n    </>\n  );\n}\n","import { useHistory } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport Grid from '@material-ui/core/Grid';\nimport Avatar from '@material-ui/core/Avatar';\nimport Divider from '@material-ui/core/Divider';\nimport Typography from '@material-ui/core/Typography';\nimport RecordVoiceOverIcon from '@material-ui/icons/RecordVoiceOver';\nimport { dateFormat, moment } from '@src/lib';\n\nconst useStyles = makeStyles(() => ({\n  title: {\n    margin: '6px auto',\n    fontWeight: 'bold',\n  },\n  description: {\n    margin: '4px auto',\n  },\n}));\n\n/**\n * @param {object} props\n * @param {CourseEntity} props.course\n */\nexport function CourseCard({ course }) {\n  const classes = useStyles();\n  const history = useHistory();\n\n  const start = dateFormat(course.started_at, 'yyyy.mm.dd');\n  const duration = moment\n    .duration(moment(course.finished_at).diff(moment(course.started_at)))\n    .asMinutes();\n\n  return (\n    <Card elevation={1}>\n      <CardActionArea\n        onClick={() => {\n          history.push(`/courses/${course.id}`);\n        }}\n      >\n        <CardContent>\n          <Grid container wrap=\"nowrap\" spacing={2}>\n            <Grid item>\n              <Avatar\n                src={course.speakers[0].avatar_url}\n                imgProps={{ referrerPolicy: 'no-referrer' }}\n              />\n            </Grid>\n            <Grid item xs zeroMinWidth>\n              <Typography variant=\"caption\" color=\"textSecondary\">\n                {[start, `${Math.ceil(duration)} minutes`].join(' · ')}\n              </Typography>\n              <Divider />\n              <Typography display=\"block\" noWrap className={classes.title}>\n                {course.title}\n              </Typography>\n              {Boolean(course.description) && (\n                <Typography\n                  display=\"block\"\n                  variant=\"caption\"\n                  color=\"textSecondary\"\n                  className={classes.description}\n                >\n                  {course.description}\n                </Typography>\n              )}\n              <Grid container direction=\"row\" alignItems=\"center\" spacing={1}>\n                <Grid item>\n                  <RecordVoiceOverIcon fontSize=\"small\" color=\"disabled\" />\n                </Grid>\n                <Grid item>\n                  <Typography variant=\"caption\" noWrap color=\"textSecondary\">\n                    {course.speakers[0].full_name}\n                  </Typography>\n                </Grid>\n              </Grid>\n            </Grid>\n          </Grid>\n        </CardContent>\n      </CardActionArea>\n    </Card>\n  );\n}\n","import { useMemo } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport { courseCollection } from '@src/configs/env';\nimport { convertToEntityList } from '@src/lib';\nimport { CourseCard } from './CourseCard';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(2),\n  },\n}));\n\nexport function CourseList() {\n  const classes = useStyles();\n  const courseEntityList = useMemo(() => convertToEntityList(courseCollection), []);\n\n  return (\n    <Grid container spacing={1} alignItems=\"stretch\" className={classes.root}>\n      {courseEntityList.map(course => (\n        <Grid key={course.id} item xs={12} sm={6}>\n          <CourseCard course={course} />\n        </Grid>\n      ))}\n    </Grid>\n  );\n}\n","import { useMount } from 'react-use';\nimport { DEFAULT_TITLE, markIndexPageAsVisted } from '@src/configs/env';\nimport Container from '@material-ui/core/Container';\nimport { useDocumentTitle } from '@src/hooks';\nimport { TitleBar } from '@src/components';\nimport { CourseList } from './CourseList';\n\nexport function IndexPage() {\n  useDocumentTitle(DEFAULT_TITLE);\n\n  useMount(() => {\n    markIndexPageAsVisted();\n  });\n\n  return (\n    <>\n      <TitleBar title={DEFAULT_TITLE} />\n      <Container maxWidth=\"md\">\n        <CourseList />\n      </Container>\n    </>\n  );\n}\n","import { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport { dateFormat, moment } from '@src/lib';\n\nconst useStyles = makeStyles(theme => ({\n  heading: {\n    'margin-top': theme.spacing(1),\n    'margin-bottom': theme.spacing(1),\n    '& > h6': {\n      'font-weight': 'bold',\n    },\n  },\n}));\n\n/**\n * @param {object} props\n * @param {CourseEntity} props.course\n */\nexport function MessageHeading({ course }) {\n  const classes = useStyles();\n\n  const start = dateFormat(course.started_at, 'yyyy.mm.dd');\n  const duration = moment\n    .duration(moment(course.finished_at).diff(moment(course.started_at)))\n    .asMinutes();\n\n  return (\n    <div className={classes.heading}>\n      <Typography variant=\"h6\" display=\"block\">\n        {course.title}\n      </Typography>\n      {Boolean(course.description) && (\n        <Typography variant=\"caption\" display=\"block\" color=\"textSecondary\">\n          {course.description}\n        </Typography>\n      )}\n      <Typography variant=\"caption\" display=\"block\" color=\"textSecondary\">\n        {[start, `${Math.ceil(duration)} minutes`].join(' · ')}\n      </Typography>\n    </div>\n  );\n}\n","import { useRef } from 'react';\nimport { useMount } from 'react-use';\nimport Card from '@material-ui/core/Card';\nimport CardMedia from '@material-ui/core/CardMedia';\n\n/**\n * @param {object} props\n * @param {MessageEntity} props.message\n */\nexport function ImageCard({ message }) {\n  const imgRef = useRef(/** @type {HTMLImageElement} */ (null));\n\n  useMount(() => {\n    const io = new IntersectionObserver(([entry]) => {\n      if (entry.isIntersecting) {\n        const image = /** @type {HTMLImageElement} */ (entry.target);\n        image.src = image.dataset['src'];\n        delete image.dataset['src'];\n        io.unobserve(entry.target);\n      }\n    });\n\n    io.observe(imgRef.current);\n\n    return () => {\n      io.disconnect();\n    };\n  });\n\n  return (\n    <Card elevation={0}>\n      <CardMedia\n        ref={imgRef}\n        component=\"img\"\n        referrerPolicy=\"no-referrer\"\n        style={{ width: '100%', minHeight: 250 }}\n        data-src={message.attachment.url}\n        src=\"\"\n      />\n    </Card>\n  );\n}\n","import { useState, useMemo, useCallback, useEffect } from 'react';\nimport { useUpdateEffect } from 'react-use';\nimport Sound from 'react-sound';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport ReplayIcon from '@material-ui/icons/Replay';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport FastRewindIcon from '@material-ui/icons/FastRewind';\nimport FastForwardIcon from '@material-ui/icons/FastForward';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { moment } from '@src/lib';\nimport { EE } from '@src/utils';\nimport { useMediaState } from '@src/components';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    position: 'relative',\n  },\n  buffer: {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    bottom: 0,\n    transition: 'width 200ms ease-out',\n    opacity: theme.palette.type === 'light' ? 0.1 : 0.15,\n    background:\n      theme.palette.type === 'light' ? theme.palette.secondary.main : theme.palette.primary.main,\n  },\n  progress: {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    bottom: 0,\n    transition: 'width 200ms ease-out',\n    opacity: theme.palette.type === 'light' ? 0.15 : 0.4,\n    background:\n      theme.palette.type === 'light' ? theme.palette.secondary.main : theme.palette.primary.main,\n  },\n  duration: {\n    position: 'absolute',\n    top: 0,\n    bottom: 0,\n    right: 8,\n    lineHeight: '38px',\n  },\n  action: {\n    paddingTop: 4,\n    paddingBottom: 4,\n  },\n}));\n\n/**\n * @param {object} props\n * @param {MessageEntity} props.message\n */\nexport function AudioCard({ message }) {\n  const classes = useStyles();\n  const [mediaState, dispathMediaAction] = useMediaState();\n\n  const [playStatus, setPlayStatus] = useState(/** @type {SoundPlayStatus} */ ('STOPPED'));\n  const [position, setPosition] = useState(0);\n  const [duration, setDuration] = useState(0);\n  const [bufferPercent, setBufferPercent] = useState(0);\n\n  const progressPercent = useMemo(() => {\n    if (!duration) {\n      return 0;\n    }\n    return (100 * position) / duration;\n  }, [position, duration]);\n\n  const readableDuration = useMemo(() => {\n    if (!duration) {\n      return null;\n    }\n\n    const remain = duration - position;\n    const md = moment.duration(remain);\n    const parts = [md.minutes(), md.seconds()];\n    if (md.hours() > 0) {\n      parts.unshift(md.hours());\n    }\n    return parts.map(x => String(x).padStart(2, '0')).join(':');\n  }, [position, duration]);\n\n  const updatePlayStatus = useCallback(\n    (/** @type {SoundPlayStatus} */ newPlayStatus) => {\n      setPlayStatus(newPlayStatus);\n\n      if (newPlayStatus === 'PLAYING') {\n        dispathMediaAction({\n          type: 'switchPlayingMediaId',\n          payload: { id: message.attachment?.id },\n        });\n      }\n    },\n    [message, dispathMediaAction],\n  );\n\n  // 快退\n  const fastRewind = useCallback(() => {\n    if (playStatus !== 'PLAYING') {\n      updatePlayStatus('PLAYING');\n    }\n\n    // -10%\n    const newProgressPercent = Math.max(0, progressPercent - 10);\n    setPosition((duration * newProgressPercent) / 100);\n  }, [playStatus, duration, progressPercent, updatePlayStatus]);\n\n  // 快进\n  const fastForward = useCallback(() => {\n    if (playStatus !== 'PLAYING') {\n      updatePlayStatus('PLAYING');\n    }\n    if (progressPercent >= 100) {\n      setPosition(0);\n    } else {\n      // +10%\n      const newProgressPercent = Math.min(progressPercent + 10, Math.min(bufferPercent, 100));\n      setPosition((duration * newProgressPercent) / 100);\n    }\n  }, [playStatus, duration, progressPercent, bufferPercent, updatePlayStatus]);\n\n  useUpdateEffect(() => {\n    if (message.attachment.id === mediaState.playingMediaId) {\n      if (playStatus !== 'PLAYING') {\n        updatePlayStatus('PLAYING');\n      }\n    } else {\n      if (playStatus === 'PLAYING') {\n        updatePlayStatus('PAUSED');\n      }\n    }\n  }, [message, mediaState.playingMediaId]);\n\n  useEffect(() => {\n    const playNextAudio = ({ id }) => {\n      if (id === message.attachment?.id) {\n        updatePlayStatus('PLAYING');\n      }\n    };\n\n    EE.on('answerNextPlayingMediaId', playNextAudio);\n\n    return () => {\n      EE.off('answerNextPlayingMediaId', playNextAudio);\n    };\n  }, [message, updatePlayStatus]);\n\n  return (\n    <>\n      <Card elevation={0} className={classes.root}>\n        <div className={classes.buffer} style={{ width: `${bufferPercent}%` }} />\n        <div className={classes.progress} style={{ width: `${progressPercent}%` }} />\n        <Typography\n          variant=\"inherit\"\n          display=\"block\"\n          noWrap\n          color=\"textSecondary\"\n          className={classes.duration}\n        >\n          {readableDuration || '--:--'}\n        </Typography>\n        <CardActions className={classes.action}>\n          <IconButton\n            size=\"small\"\n            onClick={() => {\n              updatePlayStatus(playStatus !== 'PLAYING' ? 'PLAYING' : 'PAUSED');\n            }}\n          >\n            {playStatus === 'PLAYING' && (\n              <>\n                {progressPercent >= 100 && <ReplayIcon fontSize=\"default\" color=\"action\" />}\n                {progressPercent < 100 && (\n                  <>\n                    {progressPercent < bufferPercent ? (\n                      <PauseIcon fontSize=\"default\" color=\"action\" />\n                    ) : (\n                      <CircularProgress size={24} color=\"secondary\" disableShrink />\n                    )}\n                  </>\n                )}\n              </>\n            )}\n            {playStatus !== 'PLAYING' && (\n              <>\n                {progressPercent < 100 && <PlayArrowIcon fontSize=\"default\" color=\"action\" />}\n                {progressPercent >= 100 && <ReplayIcon fontSize=\"default\" color=\"action\" />}\n              </>\n            )}\n          </IconButton>\n          <div />\n          <IconButton size=\"small\" onClick={fastRewind}>\n            <FastRewindIcon fontSize=\"small\" color=\"action\" />\n          </IconButton>\n          <IconButton size=\"small\" onClick={fastForward}>\n            <FastForwardIcon fontSize=\"small\" color=\"action\" />\n          </IconButton>\n        </CardActions>\n      </Card>\n      <Sound\n        url={message.attachment?.url}\n        playStatus={playStatus}\n        autoLoad={false}\n        loop={false}\n        playbackRate={mediaState.playbackRate}\n        position={position}\n        onLoading={({ bytesLoaded, bytesTotal, duration: dur }) => {\n          if (!duration) {\n            setDuration(dur);\n          }\n\n          setBufferPercent((100 * bytesLoaded) / bytesTotal);\n        }}\n        onPlaying={({ position }) => {\n          setPosition(position);\n        }}\n        onFinishedPlaying={() => {\n          updatePlayStatus('STOPPED');\n          EE.emit('requestNextPlayingMediaId');\n        }}\n        onError={({ errorCode, description }) => {\n          console.log('error', { errorCode, description });\n        }}\n      />\n    </>\n  );\n}\n","import { useMemo } from 'react';\nimport { marked } from '@src/lib';\nimport { renderToStaticMarkup } from 'react-dom/server.browser';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport Typography from '@material-ui/core/Typography';\nimport Link from '@material-ui/core/Link';\n\nconst useStyles = makeStyles(() => ({\n  content: {\n    paddingTop: '0px !important',\n    paddingBottom: '0px !important',\n  },\n}));\n\n/**\n * @param {object} props\n * @param {MessageEntity} props.message\n */\nexport function TextCard({ message }) {\n  const classes = useStyles();\n\n  const html = useMemo(() => {\n    const renderer = new marked.Renderer();\n\n    renderer.link = (href, title, text) => {\n      return renderToStaticMarkup(\n        <Link href={href} title={title} target=\"_blank\">\n          <Typography variant=\"inherit\" display=\"inline\" color=\"error\">\n            {text}\n          </Typography>\n        </Link>,\n      );\n    };\n\n    return marked(message.text, {\n      gfm: true,\n      mangle: true,\n      renderer,\n    });\n  }, [message]);\n\n  return (\n    <Card elevation={0}>\n      <CardContent className={classes.content}>\n        <div dangerouslySetInnerHTML={{ __html: html }} />\n      </CardContent>\n    </Card>\n  );\n}\n","import Card from '@material-ui/core/Card';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport CardContent from '@material-ui/core/CardContent';\nimport Grid from '@material-ui/core/Grid';\nimport PictureAsPdfIcon from '@material-ui/icons/PictureAsPdf';\nimport Typography from '@material-ui/core/Typography';\nimport { prettyBytes } from '@src/lib';\n\n/**\n * @param {object} props\n * @param {MessageEntity} props.message\n */\nexport function PDFCard({ message }) {\n  return (\n    <Card elevation={0}>\n      <CardActionArea\n        onClick={() => {\n          window.open(message.attachment?.url);\n        }}\n      >\n        <CardContent>\n          <Grid container wrap=\"nowrap\" spacing={2} alignItems=\"center\">\n            <Grid item>\n              <PictureAsPdfIcon fontSize=\"default\" color=\"error\" />\n            </Grid>\n            <Grid item xs zeroMinWidth>\n              <Typography variant=\"inherit\" display=\"block\" noWrap color=\"error\">\n                {message.attachment?.name}\n              </Typography>\n              <Typography variant=\"caption\" display=\"block\" noWrap color=\"textSecondary\">\n                {prettyBytes(message.attachment?.size)}\n              </Typography>\n            </Grid>\n          </Grid>\n        </CardContent>\n      </CardActionArea>\n    </Card>\n  );\n}\n","import Card from '@material-ui/core/Card';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport CardContent from '@material-ui/core/CardContent';\nimport Grid from '@material-ui/core/Grid';\nimport OndemandVideoIcon from '@material-ui/icons/OndemandVideo';\nimport Typography from '@material-ui/core/Typography';\nimport { prettyBytes } from '@src/lib';\n\n/**\n * @param {object} props\n * @param {MessageEntity} props.message\n */\nexport function VideoCard({ message }) {\n  return (\n    <Card elevation={0}>\n      <CardActionArea\n        onClick={() => {\n          window.open(message.attachment?.url);\n        }}\n      >\n        <CardContent>\n          <Grid container wrap=\"nowrap\" spacing={2} alignItems=\"center\">\n            <Grid item>\n              <OndemandVideoIcon fontSize=\"default\" color=\"error\" />\n            </Grid>\n            <Grid item xs zeroMinWidth>\n              <Typography variant=\"inherit\" display=\"block\" noWrap color=\"error\">\n                {message.attachment?.name}\n              </Typography>\n              <Typography variant=\"caption\" display=\"block\" noWrap color=\"textSecondary\">\n                {prettyBytes(message.attachment?.size)}\n              </Typography>\n            </Grid>\n          </Grid>\n        </CardContent>\n      </CardActionArea>\n    </Card>\n  );\n}\n","import { useMemo, useEffect, useCallback } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport { EE } from '@src/utils';\nimport { useMediaState } from '@src/components';\nimport { ImageCard } from './ImageCard';\nimport { AudioCard } from './AudioCard';\nimport { TextCard } from './TextCard';\nimport { PDFCard } from './PDFCard';\nimport { VideoCard } from './VideoCard';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(2),\n  },\n}));\n\n/**\n * @param {object} props\n * @param {MessageEntity[]} props.messageList\n */\nexport function MessageList({ messageList }) {\n  const classes = useStyles();\n  const [mediaState] = useMediaState();\n\n  const knownMessgeList = useMemo(() => {\n    return messageList.filter(x => {\n      if (['PLAIN_IMAGE', 'PLAIN_AUDIO', 'PLAIN_TEXT', 'PLAIN_VIDEO'].includes(x.category)) {\n        return true;\n      } else if (x.category === 'PLAIN_DATA') {\n        return ['application/pdf', 'audio/mp3', 'video/mp4'].includes(x.attachment?.mime_type);\n      } else {\n        return false;\n      }\n    });\n  }, [messageList]);\n\n  const audioMessageList = useMemo(() => {\n    return messageList.filter(x => {\n      return (\n        x.category === 'PLAIN_AUDIO' ||\n        (x.category === 'PLAIN_DATA' && x.attachment?.mime_type === 'audio/mp3')\n      );\n    });\n  }, [messageList]);\n\n  const requestNextPlayingMediaId = useCallback(() => {\n    const currentIndex = audioMessageList.findIndex(\n      x => x.attachment?.id === mediaState.playingMediaId,\n    );\n\n    if (currentIndex + 1 < audioMessageList.length) {\n      const nextPlayingMediaId = audioMessageList[currentIndex + 1]?.attachment?.id;\n      EE.emit('answerNextPlayingMediaId', { id: nextPlayingMediaId });\n    }\n  }, [mediaState.playingMediaId, audioMessageList]);\n\n  useEffect(() => {\n    EE.on('requestNextPlayingMediaId', requestNextPlayingMediaId);\n\n    return () => {\n      EE.off('requestNextPlayingMediaId', requestNextPlayingMediaId);\n    };\n  }, [requestNextPlayingMediaId]);\n\n  return (\n    <Grid container spacing={1} className={classes.root}>\n      {knownMessgeList.map(message => (\n        <Grid key={message.message_id} item xs={12} sm={12}>\n          {message.category === 'PLAIN_IMAGE' && <ImageCard message={message} />}\n          {message.category === 'PLAIN_AUDIO' && <AudioCard message={message} />}\n          {message.category === 'PLAIN_TEXT' && <TextCard message={message} />}\n          {message.category === 'PLAIN_VIDEO' && <VideoCard message={message} />}\n          {message.category === 'PLAIN_DATA' && (\n            <>\n              {message.attachment.mime_type === 'application/pdf' && <PDFCard message={message} />}\n              {message.attachment.mime_type === 'audio/mp3' && <AudioCard message={message} />}\n              {message.attachment.mime_type === 'video/mp4' && <VideoCard message={message} />}\n            </>\n          )}\n        </Grid>\n      ))}\n    </Grid>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { Redirect, useParams } from 'react-router-dom';\nimport Container from '@material-ui/core/Container';\nimport Divider from '@material-ui/core/Divider';\nimport { DEFAULT_TITLE, courseCollection } from '@src/configs/env';\nimport { TitleBar, Loading, MediaStateProvider } from '@src/components';\nimport { useDocumentTitle } from '@src/hooks';\nimport { MessageHeading } from './MessageHeading';\nimport { MessageList } from './MessageList';\n\nconst { entities: courseEntities } = courseCollection;\n\nexport function DetailPage() {\n  // @ts-ignore\n  const { courseId } = useParams();\n\n  const [fetchStatus, setFetchStatus] = useState(/** @type {LoadingState} */ ('none'));\n  const [messageList, setMessageList] = useState(/** @type {MessageEntity[]} */ ([]));\n\n  useDocumentTitle([courseEntities[courseId]?.title, DEFAULT_TITLE].filter(Boolean).join(' - '));\n\n  useEffect(() => {\n    const fetchCourseMessages = async () => {\n      try {\n        if (!courseEntities[courseId]) {\n          setFetchStatus('failed');\n          return;\n        }\n\n        setFetchStatus('loading');\n        const { default: messageList } = await import(`@src/data/courses/${courseId}.json`);\n\n        setMessageList(messageList);\n        setFetchStatus('loaded');\n      } catch (err) {\n        setFetchStatus('failed');\n      }\n    };\n\n    fetchCourseMessages();\n  }, [courseId]);\n\n  if (fetchStatus === 'failed') {\n    return <Redirect to=\"/\" />;\n  }\n\n  return (\n    <MediaStateProvider>\n      <TitleBar title={DEFAULT_TITLE} course={courseEntities[courseId]} back />\n      <Container maxWidth=\"sm\">\n        {fetchStatus === 'loading' && <Loading />}\n        {fetchStatus === 'loaded' && (\n          <>\n            {Boolean(courseEntities[courseId]) && (\n              <MessageHeading course={courseEntities[courseId]} />\n            )}\n            <Divider />\n            <MessageList messageList={messageList} />\n          </>\n        )}\n      </Container>\n    </MediaStateProvider>\n  );\n}\n","import { HashRouter as Router, Switch, Route, Redirect } from 'react-router-dom';\nimport { ThemeProvider, createMuiTheme } from '@material-ui/core/styles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { useTheme } from '@src/hooks';\nimport { IndexPage } from './routes/index';\nimport { DetailPage } from './routes/detail';\n\nfunction App() {\n  const { theme } = useTheme();\n\n  return (\n    <ThemeProvider theme={createMuiTheme(theme)}>\n      <CssBaseline />\n      <Router>\n        <Switch>\n          <Route strict exact path=\"/\">\n            <IndexPage />\n          </Route>\n          <Route strict exact path=\"/courses/:courseId\">\n            <DetailPage />\n          </Route>\n          <Redirect to=\"/\" />\n        </Switch>\n      </Router>\n    </ThemeProvider>\n  );\n}\n\nexport { App };\n","import { useCallback, useState, useEffect } from 'react';\nimport { orange, grey } from '@material-ui/core/colors';\nimport { EE } from '@src/utils';\n\nexport function useTheme() {\n  const getNextTheme = useCallback((\n    /** @type {import('@material-ui/core/styles').ThemeOptions} */ theme,\n  ) => {\n    const { type } = theme?.palette || {};\n    const paletteMode = type === 'light' ? 'dark' : 'light';\n\n    /** @type {import('@material-ui/core/styles').ThemeOptions} */\n    const nextTheme = {\n      palette: {\n        type: paletteMode,\n        primary: {\n          main: paletteMode === 'light' ? orange['A700'] : grey['900'],\n        },\n        secondary: {\n          main: paletteMode === 'light' ? orange['A400'] : grey['100'],\n        },\n        background: {\n          default: paletteMode === 'light' ? grey['300'] : grey['700'],\n        },\n      },\n    };\n\n    return nextTheme;\n  }, []);\n\n  const [theme, setTheme] = useState(() => getNextTheme(null));\n\n  const toggleTheme = useCallback(() => {\n    setTheme(getNextTheme(theme));\n  }, [theme, getNextTheme]);\n\n  useEffect(() => {\n    EE.on('toggle-theme', toggleTheme);\n    return () => EE.off('toggle-theme', toggleTheme);\n  }, [toggleTheme]);\n\n  return { theme, toggleTheme };\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './App';\nimport './index.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","export * from './dateFormat';\nexport * from './entity';\nexport * from './marked';\nexport * from './moment';\nexport * from './prettyBytes';\n","import dateFormat from 'dateformat';\n\nexport { dateFormat };\n","/**\n * 从数组创建一个 EntityCollection\n * @template T\n * @param {T[]} entityList 实体列表\n * @param {(t: T) => string} keySelector 提供一个函数，确定数组的每个元素如何确定其标识\n * @returns {EntityCollection<T>}\n */\nfunction createEntityCollection(entityList, keySelector) {\n  return {\n    list: entityList.map(t => keySelector(t)),\n    entities: entityList.reduce((ret, item) => {\n      ret[keySelector(item)] = item;\n      return ret;\n    }, {}),\n  };\n}\n\n/**\n * 将 EntityCollection 集合转换为普通数组\n * @template T\n * @param {EntityCollection<T>} collection\n * @returns {T[]}\n */\nfunction convertToEntityList(collection) {\n  return collection.list.map(key => collection.entities[key]);\n}\n\nmodule.exports = { createEntityCollection, convertToEntityList };\n","import marked from 'marked';\n\nexport { marked };\n","import moment from 'moment';\n\nexport { moment };\n","import prettyBytes from 'pretty-bytes';\n\nexport { prettyBytes };\n"],"sourceRoot":""}