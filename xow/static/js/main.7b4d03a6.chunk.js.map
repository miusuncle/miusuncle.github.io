{"version":3,"sources":["lib/index.js","lib/dateFormat.js","lib/delay.js","lib/encryptor.js","lib/entity.js","lib/marked.js","lib/moment.js","lib/prettyBytes.js","lib/scrollIntoView.js","data/courses lazy /^/.//.*/.json$/ groupOptions: {} namespace object","utils/event.js","utils/localStore.js","configs/theme.js","hooks/useDocumentTitle.js","components/TitleBar/ThemeToggler.jsx","configs/course.js","components/TitleBar/CourseFilter.jsx","configs/pbr.js","components/TitleBar/PlaybackRateSwitch.jsx","components/TitleBar/TitleBar.jsx","components/Loading.jsx","components/GlobalStateProvider.jsx","configs/env.js","routes/index/CourseList/CourseCard.jsx","routes/index/CourseList/CourseList.jsx","routes/index/IndexPage.jsx","routes/detail/MessageHeading.jsx","routes/detail/MessageList/ImageCard.jsx","routes/detail/MessageList/AudioCard.jsx","routes/detail/MessageList/TextCard.jsx","routes/detail/MessageList/PDFCard.jsx","routes/detail/MessageList/VideoCard.jsx","routes/detail/MessageList/MessageList.jsx","routes/detail/DetailPage.jsx","App.jsx","hooks/useTheme.js","index.jsx"],"names":["delay","ms","Promise","resolve","setTimeout","encryptor","createEncryptor","key","repeat","hmac","debug","decrypt","encrypt","obj","result","includes","module","exports","createEntityCollection","entityList","keySelector","list","map","t","entities","reduce","ret","item","convertToEntityList","collection","webpackAsyncContext","req","__webpack_require__","o","then","e","Error","code","ids","id","keys","Object","EE","EventEmitter","localStore","JSON","parse","localStorage","getItem","err","value","setItem","stringify","THEME_TYPE_STORED_KEY","getThemeConfig","type","palette","primary","main","orange","grey","light","dark","contrastText","secondary","background","default","contrastThreshold","tonalOffset","require","useRef","useEffect","useDocumentTitle","title","retainOnUnmount","defaultTitle","document","current","ThemeToggler","theme","useTheme","IconButton","edge","color","onClick","emit","courseCollection","courseList","x","fuzzyId","String","coursePhaseCollection","text","brief","courseIds","DEFAULT_COURSE_PHASE","COURSE_PHASE_STORED_KEY","coursePhaseEntites","useStyles","makeStyles","icon","minWidth","CourseFilter","classes","useState","open","setOpen","useGlobalState","globalState","dispathAction","updateCoursePhase","useCallback","coursePhase","payload","listItems","useMemo","coursePhaseEntityList","List","component","subheader","ListSubheader","selected","ListItem","button","window","scrollTo","ListItemText","Typography","ListItemIcon","className","useMount","Number","Badge","badgeContent","Drawer","anchor","variant","onClose","playbackRateCollection","DEFAULT_PLAYBACK_RATE","PLAYBACK_RATE_STORED_KEY","pbrEntites","PlaybackRateSwitch","updatePlaybackRate","playbackRate","playbackRateEntityList","pbr","toolbar","paddingLeft","spacing","paddingRight","marginRight","filter","flexGrow","mainTitle","fontSize","subTitle","verticalAlign","offset","mixins","TitleBar","course","back","history","useHistory","trigger","useScrollTrigger","disableHysteresis","threshold","revealCourseBrief","AppBar","position","elevation","Toolbar","disableRipple","replace","display","noWrap","Boolean","description","join","loading","Loading","CircularProgress","globalReducer","state","action","playingMediaId","GlobalStateContext","createContext","intialState","useContext","GlobalStateProvider","children","Provider","useReducer","DEFAULT_TITLE","margin","fontWeight","avatar","CourseCard","start","dateFormat","started_at","duration","moment","asMinutes","Card","CardActionArea","push","CardContent","Grid","container","wrap","Avatar","src","speakers","avatar_url","imgProps","referrerPolicy","xs","zeroMinWidth","Math","ceil","Divider","direction","alignItems","full_name","root","paddingTop","paddingBottom","CourseList","courseEntityList","sm","pageScrollTop","IndexPage","y","useWindowScroll","useUpdateEffect","documentElement","scrollTop","Container","maxWidth","heading","MessageHeading","ImageCard","message","imgRef","useEffectOnce","io","IntersectionObserver","entry","isIntersecting","image","target","dataset","style","minHeight","unobserve","disconnect","rootMargin","observe","CardMedia","ref","width","data-src","attachment","url","buffer","height","left","transition","opacity","progress","top","transform","right","AudioCard","rootRef","playStatus","setPlayStatus","finished","setFinished","byteLoaded","setBytesLoaded","bytesTotal","setBytesTotal","waitBuffer","setWaitBuffer","setPosition","setDuration","bufferPercent","progressPercent","remainDuration","remain","parts","minutes","seconds","hours","unshift","padStart","updatePosition","notifyPlayAudio","notifyPauseAudio","playNextAudio","scrollIntoView","parentElement","scrollMode","block","inline","behavior","on","off","doFastRewind","newProgressPercent","max","doFastForward","min","CardActions","size","disableShrink","autoLoad","loop","onLoading","info","bytesLoaded","onPlaying","onFinishedPlaying","onError","errorCode","console","log","content","link","TextCard","html","renderer","marked","Renderer","href","renderToStaticMarkup","Link","rel","gfm","mangle","dangerouslySetInnerHTML","__html","PDFCard","name","prettyBytes","VideoCard","MessageList","messageList","soundManager","setup","ignoreMobileRestrictions","useUnmount","knownMessgeList","category","mime_type","audioMessageList","replyNextPlayingMediaId","currentIndex","findIndex","length","nextPlayingMediaId","message_id","courseEntities","DetailPage","encryptedId","useParams","courseId","tryCountRef","fetchStatus","setFetchStatus","setMessageList","fetchMessageList","a","to","App","themeConfig","setTheme","toggleTheme","nextType","createMuiTheme","ThemeProvider","CssBaseline","strict","exact","path","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.7b4d03a6.chunk.js","sourcesContent":["export * from './dateFormat';\nexport * from './delay';\nexport * from './encryptor';\nexport * from './entity';\nexport * from './marked';\nexport * from './moment';\nexport * from './prettyBytes';\nexport * from './scrollIntoView';\n","import dateFormat from 'dateformat';\n\nexport { dateFormat };\n","export function delay(ms = 1000) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n","import { createEncryptor } from 'simple-encryptor';\n\nconst encryptor = createEncryptor({\n  key: 'yuer'.repeat(4),\n  hmac: false,\n  debug: false,\n});\n\nconst { decrypt } = encryptor;\n\nexport const encrypt = obj => {\n  while (true) {\n    const result = encryptor.encrypt(obj);\n    if (!result.includes('/')) {\n      return result;\n    }\n  }\n};\n\nexport { decrypt };\n","/**\n * 从数组创建一个 EntityCollection\n * @template T\n * @param {T[]} entityList 实体列表\n * @param {(t: T) => string} keySelector 提供一个函数，确定数组的每个元素如何确定其标识\n * @returns {EntityCollection<T>}\n */\nfunction createEntityCollection(entityList, keySelector) {\n  return {\n    list: entityList.map(t => keySelector(t)),\n    entities: entityList.reduce((ret, item) => {\n      ret[keySelector(item)] = item;\n      return ret;\n    }, {}),\n  };\n}\n\n/**\n * 将 EntityCollection 集合转换为普通数组\n * @template T\n * @param {EntityCollection<T>} collection\n * @returns {T[]}\n */\nfunction convertToEntityList(collection) {\n  return collection.list.map(key => collection.entities[key]);\n}\n\nmodule.exports = { createEntityCollection, convertToEntityList };\n","import marked from 'marked';\n\nexport { marked };\n","import moment from 'moment';\n\nexport { moment };\n","import prettyBytes from 'pretty-bytes';\n\nexport { prettyBytes };\n","import scrollIntoView from 'smooth-scroll-into-view-if-needed';\n\nexport { scrollIntoView };\n","var map = {\n\t\"./2192.json\": [\n\t\t348,\n\t\t3\n\t],\n\t\"./2195.json\": [\n\t\t349,\n\t\t4\n\t],\n\t\"./2227.json\": [\n\t\t350,\n\t\t5\n\t],\n\t\"./2270.json\": [\n\t\t351,\n\t\t6\n\t],\n\t\"./2322.json\": [\n\t\t352,\n\t\t7\n\t],\n\t\"./2367.json\": [\n\t\t353,\n\t\t8\n\t],\n\t\"./2415.json\": [\n\t\t354,\n\t\t9\n\t],\n\t\"./2454.json\": [\n\t\t355,\n\t\t10\n\t],\n\t\"./2460.json\": [\n\t\t356,\n\t\t11\n\t],\n\t\"./2503.json\": [\n\t\t357,\n\t\t12\n\t],\n\t\"./2520.json\": [\n\t\t358,\n\t\t13\n\t],\n\t\"./2545.json\": [\n\t\t359,\n\t\t14\n\t],\n\t\"./2584.json\": [\n\t\t360,\n\t\t15\n\t],\n\t\"./2624.json\": [\n\t\t361,\n\t\t16\n\t],\n\t\"./2644.json\": [\n\t\t362,\n\t\t17\n\t],\n\t\"./2654.json\": [\n\t\t363,\n\t\t18\n\t],\n\t\"./2676.json\": [\n\t\t364,\n\t\t19\n\t],\n\t\"./2695.json\": [\n\t\t365,\n\t\t20\n\t],\n\t\"./2709.json\": [\n\t\t366,\n\t\t21\n\t],\n\t\"./2732.json\": [\n\t\t367,\n\t\t22\n\t],\n\t\"./2769.json\": [\n\t\t368,\n\t\t23\n\t],\n\t\"./2790.json\": [\n\t\t369,\n\t\t24\n\t],\n\t\"./2801.json\": [\n\t\t370,\n\t\t25\n\t],\n\t\"./2821.json\": [\n\t\t371,\n\t\t26\n\t],\n\t\"./2860.json\": [\n\t\t372,\n\t\t27\n\t],\n\t\"./2903.json\": [\n\t\t373,\n\t\t28\n\t],\n\t\"./2967.json\": [\n\t\t374,\n\t\t29\n\t],\n\t\"./3013.json\": [\n\t\t375,\n\t\t30\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 3);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 344;\nmodule.exports = webpackAsyncContext;","import EventEmitter from 'eventemitter3';\n\nexport { EventEmitter };\nexport const EE = new EventEmitter();\n","export const localStore = {\n  /**\n   * @param {string} key\n   */\n  get(key) {\n    try {\n      return JSON.parse(localStorage.getItem(key));\n    } catch (err) {\n      return undefined;\n    }\n  },\n\n  /**\n   * @param {string} key\n   * @param {any} value\n   */\n  set(key, value) {\n    try {\n      localStorage.setItem(key, JSON.stringify(value));\n      return true;\n    } catch (err) {\n      return false;\n    }\n  },\n\n  /**\n   * @param {string} key\n   */\n  del(key) {\n    try {\n      localStorage.removeItem(key);\n      return true;\n    } catch (err) {\n      return false;\n    }\n  },\n\n  isSupport() {\n    try {\n      const whatever = 'whatever';\n      localStorage.setItem(whatever, whatever);\n      localStorage.removeItem(whatever);\n      return true;\n    } catch (err) {\n      return false;\n    }\n  },\n};\n","import { orange, grey } from '@material-ui/core/colors';\n\nexport const THEME_TYPE_STORED_KEY = 'xow-theme';\n\nexport const getThemeConfig = (/** @type {import('@material-ui/core').PaletteType} */ type) => {\n  return /** @type {import('@material-ui/core/styles').ThemeOptions} */ ({\n    palette: {\n      type,\n      primary: {\n        main: type === 'light' ? orange['A700'] : grey['900'],\n        light: orange['A700'],\n        dark: grey['900'],\n        contrastText: '#fff',\n      },\n      secondary: {\n        main: type === 'light' ? orange['A400'] : 'rgba(255, 255, 255, 0.7)',\n        light: orange['A400'],\n        dark: 'rgba(255, 255, 255, 0.7)',\n        contrastText: '#000',\n      },\n      background: {\n        default: type === 'light' ? grey['300'] : grey['700'],\n      },\n      contrastThreshold: 3,\n      tonalOffset: 0.2,\n    },\n  });\n};\n","const { useRef, useEffect } = require('react');\n\n/**\n * @param {string} title 文档标题\n * @param {boolean} [retainOnUnmount] 页面卸载后保留标题？\n */\nexport function useDocumentTitle(title, retainOnUnmount = false) {\n  const defaultTitle = useRef(document.title);\n\n  useEffect(() => {\n    document.title = title;\n  }, [title]);\n\n  useEffect(() => {\n    const title = defaultTitle.current;\n    return () => {\n      if (!retainOnUnmount) {\n        document.title = title;\n      }\n    };\n  }, [retainOnUnmount]);\n}\n","import { useTheme } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\nimport Brightness7Icon from '@material-ui/icons/Brightness7';\nimport Brightness4Icon from '@material-ui/icons/Brightness4';\nimport { EE } from '@src/utils';\n\nexport function ThemeToggler() {\n  const theme = useTheme();\n\n  return (\n    <IconButton\n      edge=\"start\"\n      color=\"inherit\"\n      onClick={() => {\n        EE.emit('toggle-theme');\n      }}\n    >\n      {theme.palette.type === 'light' ? <Brightness4Icon /> : <Brightness7Icon />}\n    </IconButton>\n  );\n}\n","import { createEntityCollection, encrypt } from '@src/lib';\nimport courseList from '@src/data/index.json';\n\n/** @type {EntityCollection<CourseEntity>} */\nexport const courseCollection = createEntityCollection(\n  courseList.map(x => ({ ...x, fuzzyId: encrypt(x.id) })),\n  x => String(x.id),\n);\n\nexport const coursePhaseCollection = createEntityCollection(\n  [\n    {\n      text: '第一期',\n      value: 1,\n      brief: '𝟭',\n      courseIds: [2192, 2195, 2227, 2270, 2322, 2367, 2415, 2454, 2460, 2503, 2520, 2545],\n    },\n    {\n      text: '第二期',\n      value: 2,\n      brief: '𝟮',\n      courseIds: [2584, 2624, 2644, 2654, 2676, 2695, 2709, 2732],\n    },\n    {\n      text: '第三期',\n      value: 3,\n      brief: '𝟯',\n      courseIds: [2769, 2790, 2801, 2821, 2860, 2903, 2967, 3013],\n    },\n  ],\n  x => String(x.value),\n);\n\nexport const DEFAULT_COURSE_PHASE = coursePhaseCollection.entities[1].value;\n\n/** `localStorage` key */\nexport const COURSE_PHASE_STORED_KEY = 'xow-course-phase';\n","import { useCallback, useMemo, useState } from 'react';\nimport { useMount } from 'react-use';\nimport { useTheme } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Drawer from '@material-ui/core/Drawer';\nimport Badge from '@material-ui/core/Badge';\nimport IconButton from '@material-ui/core/IconButton';\nimport FilterListIcon from '@material-ui/icons/FilterList';\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\nimport { convertToEntityList } from '@src/lib';\nimport {\n  coursePhaseCollection,\n  DEFAULT_COURSE_PHASE,\n  COURSE_PHASE_STORED_KEY,\n} from '@src/configs/course';\nimport { useGlobalState } from '@src/components';\nimport { localStore } from '@src/utils';\n\nconst { entities: coursePhaseEntites } = coursePhaseCollection;\n\nconst useStyles = makeStyles(() => ({\n  icon: {\n    minWidth: 'auto',\n  },\n}));\n\nexport function CourseFilter() {\n  const theme = useTheme();\n  const classes = useStyles();\n\n  const [open, setOpen] = useState(false);\n  const [globalState, dispathAction] = useGlobalState();\n\n  const updateCoursePhase = useCallback(\n    (/** @type {number} */ coursePhase) => {\n      dispathAction({\n        type: 'updateCoursePhase',\n        payload: { value: coursePhase },\n      });\n    },\n    [dispathAction],\n  );\n\n  const listItems = useMemo(() => {\n    const coursePhaseEntityList = convertToEntityList(coursePhaseCollection);\n\n    return (\n      <List component=\"div\" subheader={<ListSubheader component=\"div\">{'课程期别'}</ListSubheader>}>\n        {coursePhaseEntityList.map(coursePhase => {\n          const selected = coursePhase.value === globalState.coursePhase;\n\n          return (\n            <ListItem\n              key={coursePhase.value}\n              button\n              selected={selected}\n              onClick={() => {\n                updateCoursePhase(coursePhase.value);\n                setOpen(false);\n\n                if (coursePhase.value !== globalState.coursePhase) {\n                  window.scrollTo(0, 0);\n                }\n              }}\n            >\n              <ListItemText\n                primary={\n                  <Typography\n                    color={\n                      selected\n                        ? theme.palette.type === 'light'\n                          ? 'primary'\n                          : 'textPrimary'\n                        : theme.palette.type === 'light'\n                        ? 'inherit'\n                        : 'textSecondary'\n                    }\n                  >\n                    {coursePhase.text}\n                  </Typography>\n                }\n              />\n              <ListItemIcon className={classes.icon}>\n                <CheckCircleIcon\n                  color={\n                    selected ? (theme.palette.type === 'light' ? 'primary' : 'inherit') : 'disabled'\n                  }\n                />\n              </ListItemIcon>\n            </ListItem>\n          );\n        })}\n      </List>\n    );\n  }, [theme, classes.icon, globalState, updateCoursePhase]);\n\n  useMount(() => {\n    // init `coursePhase`\n    let coursePhase = localStore.get(COURSE_PHASE_STORED_KEY);\n    if (!coursePhaseCollection.list.includes(String(coursePhase))) {\n      coursePhase = DEFAULT_COURSE_PHASE;\n    }\n    updateCoursePhase(Number(coursePhase));\n  });\n\n  return (\n    <>\n      <IconButton\n        edge=\"start\"\n        color=\"inherit\"\n        onClick={() => {\n          setOpen(true);\n        }}\n      >\n        <Badge badgeContent={coursePhaseEntites[globalState.coursePhase].brief} color=\"primary\">\n          <FilterListIcon />\n        </Badge>\n      </IconButton>\n      <Drawer anchor=\"bottom\" variant=\"temporary\" open={open} onClose={() => setOpen(false)}>\n        {listItems}\n      </Drawer>\n    </>\n  );\n}\n","import { createEntityCollection } from '@src/lib';\n\nexport const playbackRateCollection = createEntityCollection(\n  [\n    { text: '0.75x', value: 0.75 },\n    { text: '正常倍速', value: 1 },\n    { text: '1.25x', value: 1.25 },\n    { text: '1.5x', value: 1.5 },\n    { text: '2.0x', value: 2 },\n    { text: '2.5x', value: 2.5 },\n    { text: '3.0x', value: 3 },\n  ],\n  x => String(x.value),\n);\n\nexport const DEFAULT_PLAYBACK_RATE = playbackRateCollection.entities[1].value;\n\n/** `localStorage` key */\nexport const PLAYBACK_RATE_STORED_KEY = 'xow-pbr';\n","import { useCallback, useMemo, useState } from 'react';\nimport { useMount } from 'react-use';\nimport { useTheme } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Drawer from '@material-ui/core/Drawer';\nimport Badge from '@material-ui/core/Badge';\nimport IconButton from '@material-ui/core/IconButton';\nimport SlowMotionVideoIcon from '@material-ui/icons/SlowMotionVideo';\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\nimport { convertToEntityList } from '@src/lib';\nimport {\n  playbackRateCollection,\n  DEFAULT_PLAYBACK_RATE,\n  PLAYBACK_RATE_STORED_KEY,\n} from '@src/configs/pbr';\nimport { useGlobalState } from '@src/components';\nimport { localStore } from '@src/utils';\n\nconst { entities: pbrEntites } = playbackRateCollection;\n\nconst useStyles = makeStyles(() => ({\n  icon: {\n    minWidth: 'auto',\n  },\n}));\n\nexport function PlaybackRateSwitch() {\n  const theme = useTheme();\n  const classes = useStyles();\n\n  const [open, setOpen] = useState(false);\n  const [globalState, dispathAction] = useGlobalState();\n\n  const updatePlaybackRate = useCallback(\n    (/** @type {number} */ playbackRate) => {\n      dispathAction({\n        type: 'updatePlaybackRate',\n        payload: { value: playbackRate },\n      });\n    },\n    [dispathAction],\n  );\n\n  const listItems = useMemo(() => {\n    const playbackRateEntityList = convertToEntityList(playbackRateCollection);\n\n    return (\n      <List\n        component=\"div\"\n        subheader={<ListSubheader component=\"div\">{'音频播放倍速'}</ListSubheader>}\n      >\n        {playbackRateEntityList.map(pbr => {\n          const selected = pbr.value === globalState.playbackRate;\n\n          return (\n            <ListItem\n              key={pbr.value}\n              button\n              selected={selected}\n              onClick={() => {\n                updatePlaybackRate(pbr.value);\n                setOpen(false);\n              }}\n            >\n              <ListItemText\n                primary={\n                  <Typography\n                    color={\n                      selected\n                        ? theme.palette.type === 'light'\n                          ? 'primary'\n                          : 'textPrimary'\n                        : theme.palette.type === 'light'\n                        ? 'inherit'\n                        : 'textSecondary'\n                    }\n                  >\n                    {pbr.text}\n                  </Typography>\n                }\n              />\n              <ListItemIcon className={classes.icon}>\n                <CheckCircleIcon\n                  color={\n                    selected ? (theme.palette.type === 'light' ? 'primary' : 'inherit') : 'disabled'\n                  }\n                />\n              </ListItemIcon>\n            </ListItem>\n          );\n        })}\n      </List>\n    );\n  }, [theme, classes.icon, globalState, updatePlaybackRate]);\n\n  useMount(() => {\n    // init `playbackRate`\n    let playbackRate = localStore.get(PLAYBACK_RATE_STORED_KEY);\n    if (!playbackRateCollection.list.includes(String(playbackRate))) {\n      playbackRate = DEFAULT_PLAYBACK_RATE;\n    }\n    updatePlaybackRate(Number(playbackRate));\n  });\n\n  return (\n    <>\n      <IconButton\n        edge=\"start\"\n        color=\"inherit\"\n        onClick={() => {\n          setOpen(true);\n        }}\n      >\n        <Badge\n          badgeContent={\n            pbrEntites[globalState.playbackRate].value === 1\n              ? null\n              : pbrEntites[globalState.playbackRate].text\n          }\n          color=\"primary\"\n        >\n          <SlowMotionVideoIcon />\n        </Badge>\n      </IconButton>\n      <Drawer anchor=\"bottom\" variant=\"temporary\" open={open} onClose={() => setOpen(false)}>\n        {listItems}\n      </Drawer>\n    </>\n  );\n}\n","import { useHistory } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport BorderColorIcon from '@material-ui/icons/BorderColor';\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\nimport useScrollTrigger from '@material-ui/core/useScrollTrigger';\nimport { ThemeToggler } from './ThemeToggler';\nimport { CourseFilter } from './CourseFilter';\nimport { PlaybackRateSwitch } from './PlaybackRateSwitch';\n\nconst useStyles = makeStyles(theme => ({\n  toolbar: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1),\n  },\n  icon: {\n    marginRight: theme.spacing(1),\n  },\n  filter: {\n    marginRight: theme.spacing(2),\n  },\n  pbr: {\n    marginRight: theme.spacing(2),\n  },\n  title: {\n    flexGrow: 1,\n  },\n  mainTitle: {\n    'fontWeight': 'bold',\n    '& > sup': {\n      fontSize: '80%',\n    },\n  },\n  subTitle: {\n    verticalAlign: 'top',\n  },\n  offset: theme.mixins.toolbar,\n}));\n\n/**\n * @param {object} props\n * @param {string} props.title 标题\n * @param {CourseEntity} [props.course] 课程对象\n * @param {boolean} [props.back] 是否返回？\n */\nexport function TitleBar({ title, course, back }) {\n  const history = useHistory();\n  const classes = useStyles();\n\n  const trigger = useScrollTrigger({\n    disableHysteresis: true,\n    threshold: 0,\n  });\n\n  const revealCourseBrief = useScrollTrigger({\n    disableHysteresis: true,\n    threshold: 80,\n  });\n\n  return (\n    <>\n      <AppBar position=\"fixed\" elevation={trigger ? 4 : 0}>\n        <Toolbar variant=\"regular\" className={classes.toolbar}>\n          {!back && (\n            <IconButton color=\"inherit\" className={classes.icon} disableRipple>\n              <BorderColorIcon />\n            </IconButton>\n          )}\n          {back && (\n            <IconButton\n              color=\"inherit\"\n              className={classes.icon}\n              onClick={() => {\n                history.replace('/');\n              }}\n            >\n              <ArrowBackIcon />\n            </IconButton>\n          )}\n          <Typography variant=\"inherit\" display=\"block\" noWrap className={classes.title}>\n            <Typography variant=\"h6\" color=\"inherit\" className={classes.mainTitle}>\n              {title}\n              <sup>{'ᵇᵉᵗᵃ'}</sup>\n            </Typography>\n            {Boolean(revealCourseBrief && course) && (\n              <Typography variant={'caption'} color=\"inherit\" className={classes.subTitle}>\n                {[course.title, course.description].filter(Boolean).join(' · ')}\n              </Typography>\n            )}\n          </Typography>\n\n          {Boolean(!course) && (\n            <div className={classes.filter}>\n              <CourseFilter />\n            </div>\n          )}\n          {Boolean(course) && (\n            <div className={classes.pbr}>\n              <PlaybackRateSwitch />\n            </div>\n          )}\n          <ThemeToggler />\n        </Toolbar>\n      </AppBar>\n\n      {/* @see https://material-ui.com/components/app-bar/#fixed-placement */}\n      <div className={classes.offset} />\n    </>\n  );\n}\n","import { makeStyles } from '@material-ui/core/styles';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\nconst useStyles = makeStyles(theme => ({\n  loading: {\n    'display': 'flex',\n    'justify-content': 'center',\n    'margin': '100px 0',\n  },\n}));\n\nexport function Loading() {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.loading}>\n      <CircularProgress color={'secondary'} />\n    </div>\n  );\n}\n","import React, { createContext, useReducer, useContext } from 'react';\nimport { localStore } from '@src/utils';\nimport { DEFAULT_COURSE_PHASE, COURSE_PHASE_STORED_KEY } from '@src/configs/course';\nimport { DEFAULT_PLAYBACK_RATE, PLAYBACK_RATE_STORED_KEY } from '@src/configs/pbr';\n\n/**\n * @param {GlobalState} state\n * @param {GlobalAction} action\n */\nconst globalReducer = (state, action) => {\n  const { type, payload } = action;\n\n  switch (type) {\n    case 'updateCoursePhase': {\n      const coursePhase = payload['value'];\n      localStore.set(COURSE_PHASE_STORED_KEY, coursePhase);\n      return { ...state, coursePhase };\n    }\n\n    case 'updatePlaybackRate': {\n      const playbackRate = payload['value'];\n      localStore.set(PLAYBACK_RATE_STORED_KEY, playbackRate);\n      return { ...state, playbackRate };\n    }\n\n    case 'switchPlayingMediaId': {\n      return { ...state, playingMediaId: payload['id'] || null };\n    }\n\n    default:\n      return state;\n  }\n};\n\nconst GlobalStateContext = createContext(null);\n\n/** @type {GlobalState} */\nconst intialState = {\n  coursePhase: DEFAULT_COURSE_PHASE,\n  playbackRate: DEFAULT_PLAYBACK_RATE,\n  playingMediaId: null,\n};\n\n/**\n * @type {() => [GlobalState, React.Dispatch<GlobalAction>]}\n */\nexport const useGlobalState = () => useContext(GlobalStateContext);\n\nexport function GlobalStateProvider({ children }) {\n  return (\n    <GlobalStateContext.Provider value={useReducer(globalReducer, intialState)}>\n      {children}\n    </GlobalStateContext.Provider>\n  );\n}\n","export const DEFAULT_TITLE = '笑来写作课';\n","import { useHistory } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport Grid from '@material-ui/core/Grid';\nimport Avatar from '@material-ui/core/Avatar';\nimport Divider from '@material-ui/core/Divider';\nimport Typography from '@material-ui/core/Typography';\nimport RecordVoiceOverIcon from '@material-ui/icons/RecordVoiceOver';\nimport { dateFormat, moment } from '@src/lib';\n\nconst useStyles = makeStyles(theme => ({\n  title: {\n    margin: '6px auto 4px',\n    fontWeight: 'bold',\n  },\n  avatar: {\n    background: theme.palette.background.default,\n  },\n  description: {\n    margin: '4px auto',\n  },\n}));\n\n/**\n * @param {object} props\n * @param {CourseEntity} props.course\n */\nexport function CourseCard({ course }) {\n  const classes = useStyles();\n  const history = useHistory();\n\n  const start = dateFormat(course.started_at, 'yyyy.mm.dd');\n  const duration = moment.duration(course.duration).asMinutes();\n\n  return (\n    <Card elevation={1}>\n      <CardActionArea\n        onClick={() => {\n          history.push(`/courses/${course.fuzzyId}`);\n        }}\n      >\n        <CardContent>\n          <Grid container wrap=\"nowrap\" spacing={2}>\n            <Grid item>\n              <Avatar\n                variant=\"circular\"\n                src={course.speakers[0].avatar_url}\n                imgProps={{ referrerPolicy: 'no-referrer' }}\n                className={classes.avatar}\n              />\n            </Grid>\n            <Grid item xs zeroMinWidth>\n              <Typography variant=\"caption\" color=\"textSecondary\">\n                {[start, `${Math.ceil(duration)} minutes`].join(' · ')}\n              </Typography>\n              <Divider />\n              <Typography display=\"block\" noWrap className={classes.title}>\n                {course.title}\n              </Typography>\n              <Typography\n                display=\"block\"\n                variant=\"caption\"\n                color=\"textSecondary\"\n                className={classes.description}\n              >\n                {course.description || '↩︎'}\n              </Typography>\n              <Grid container direction=\"row\" alignItems=\"center\" spacing={1}>\n                <Grid item>\n                  <RecordVoiceOverIcon fontSize=\"small\" color=\"disabled\" />\n                </Grid>\n                <Grid item>\n                  <Typography variant=\"caption\" noWrap color=\"textSecondary\">\n                    {course.speakers[0].full_name}\n                  </Typography>\n                </Grid>\n              </Grid>\n            </Grid>\n          </Grid>\n        </CardContent>\n      </CardActionArea>\n    </Card>\n  );\n}\n","import { useMemo } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport { courseCollection } from '@src/configs/course';\nimport { coursePhaseCollection } from '@src/configs/course';\nimport { convertToEntityList } from '@src/lib';\nimport { useGlobalState } from '@src/components';\nimport { CourseCard } from './CourseCard';\n\nconst { entities: coursePhaseEntites } = coursePhaseCollection;\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(2),\n  },\n}));\n\nexport function CourseList() {\n  const classes = useStyles();\n  const [globalState] = useGlobalState();\n  const courseEntityList = useMemo(() => {\n    return convertToEntityList({\n      entities: courseCollection.entities,\n      list: coursePhaseEntites[globalState.coursePhase].courseIds.map(String),\n    });\n  }, [globalState.coursePhase]);\n\n  return (\n    <Grid container spacing={2} alignItems=\"stretch\" className={classes.root}>\n      {courseEntityList.map(course => (\n        <Grid key={course.id} item xs={12} sm={6}>\n          <CourseCard course={course} />\n        </Grid>\n      ))}\n    </Grid>\n  );\n}\n","import { useMount, useUpdateEffect, useWindowScroll } from 'react-use';\nimport { DEFAULT_TITLE } from '@src/configs/env';\nimport Container from '@material-ui/core/Container';\nimport { useDocumentTitle } from '@src/hooks';\nimport { TitleBar } from '@src/components';\nimport { CourseList } from './CourseList';\n\nlet pageScrollTop = 0;\n\nexport function IndexPage() {\n  useDocumentTitle(DEFAULT_TITLE);\n\n  const { y } = useWindowScroll();\n\n  useUpdateEffect(() => {\n    pageScrollTop = y;\n  }, [y]);\n\n  useMount(() => {\n    document.documentElement.scrollTop = pageScrollTop;\n  });\n\n  return (\n    <>\n      <TitleBar title={DEFAULT_TITLE} />\n      <Container maxWidth=\"md\">\n        <CourseList />\n      </Container>\n    </>\n  );\n}\n","import { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport { dateFormat, moment } from '@src/lib';\n\nconst useStyles = makeStyles(theme => ({\n  heading: {\n    'margin-top': theme.spacing(1),\n    'margin-bottom': theme.spacing(1),\n    '& > h6': {\n      'font-weight': 'bold',\n    },\n  },\n}));\n\n/**\n * @param {object} props\n * @param {CourseEntity} props.course\n */\nexport function MessageHeading({ course }) {\n  const classes = useStyles();\n\n  const start = dateFormat(course.started_at, 'yyyy.mm.dd');\n  const duration = moment.duration(course.duration).asMinutes();\n\n  return (\n    <div className={classes.heading}>\n      <Typography variant=\"h6\" display=\"block\">\n        {course.title}\n      </Typography>\n      {Boolean(course.description) && (\n        <Typography variant=\"caption\" display=\"block\" color=\"textSecondary\">\n          {course.description}\n        </Typography>\n      )}\n      <Typography variant=\"caption\" display=\"block\" color=\"textSecondary\">\n        {[start, `${Math.ceil(duration)} minutes`].join(' · ')}\n      </Typography>\n    </div>\n  );\n}\n","import { useRef } from 'react';\nimport { useEffectOnce } from 'react-use';\nimport Card from '@material-ui/core/Card';\nimport CardMedia from '@material-ui/core/CardMedia';\n\n/**\n * @param {object} props\n * @param {MessageEntity} props.message\n */\nexport function ImageCard({ message }) {\n  const imgRef = useRef(/** @type {HTMLImageElement} */ (null));\n\n  useEffectOnce(() => {\n    const io = new IntersectionObserver(\n      ([entry]) => {\n        if (entry.isIntersecting) {\n          const image = /** @type {HTMLImageElement} */ (entry.target);\n\n          image.src = image.dataset['src'];\n          image.style.minHeight = 'auto';\n          delete image.dataset['src'];\n\n          io.unobserve(entry.target);\n          io.disconnect();\n        }\n      },\n      { rootMargin: '900px' },\n    );\n\n    io.observe(imgRef.current);\n\n    return () => {\n      io.disconnect();\n    };\n  });\n\n  return (\n    <Card elevation={0}>\n      <CardMedia\n        ref={imgRef}\n        component=\"img\"\n        referrerPolicy=\"no-referrer\"\n        style={{ width: '100%', minHeight: 300 }}\n        data-src={message.attachment.url}\n        src=\"\"\n      />\n    </Card>\n  );\n}\n","import { useState, useMemo, useCallback, useEffect, useRef } from 'react';\nimport { useUpdateEffect } from 'react-use';\nimport Sound from 'react-sound';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport ReplayIcon from '@material-ui/icons/Replay';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport FastRewindIcon from '@material-ui/icons/FastRewind';\nimport FastForwardIcon from '@material-ui/icons/FastForward';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { moment, scrollIntoView } from '@src/lib';\nimport { EE } from '@src/utils';\nimport { useGlobalState } from '@src/components';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    position: 'relative',\n  },\n  buffer: {\n    position: 'absolute',\n    height: '100%',\n    left: 0,\n    transition: 'width 200ms ease-out',\n    opacity: 0.1,\n    background: theme.palette.secondary.main,\n  },\n  progress: {\n    position: 'absolute',\n    height: '100%',\n    left: 0,\n    transition: 'width 200ms ease-out',\n    opacity: 0.15,\n    background: theme.palette.primary.main,\n  },\n  duration: {\n    position: 'absolute',\n    top: '50%',\n    transform: 'translateY(-50%)',\n    right: 12,\n  },\n  action: {\n    height: 38,\n    paddingTop: 4,\n    paddingBottom: 4,\n  },\n}));\n\n/**\n * @param {object} props\n * @param {MessageEntity} props.message\n */\nexport function AudioCard({ message }) {\n  const rootRef = useRef(/** @type {HTMLElement} */ (null));\n  const classes = useStyles();\n  const [globalState, dispathAction] = useGlobalState();\n\n  const [playStatus, setPlayStatus] = useState(/** @type {SoundPlayStatus} */ ('STOPPED'));\n  const [finished, setFinished] = useState(false);\n\n  const [byteLoaded, setBytesLoaded] = useState(0);\n  const [bytesTotal, setBytesTotal] = useState(0);\n  const [waitBuffer, setWaitBuffer] = useState(false);\n\n  const [position, setPosition] = useState(0);\n  const [duration, setDuration] = useState(0);\n\n  const bufferPercent = useMemo(() => {\n    if (!bytesTotal) {\n      return 0;\n    }\n    return (100 * byteLoaded) / bytesTotal;\n  }, [byteLoaded, bytesTotal]);\n\n  const progressPercent = useMemo(() => {\n    if (!duration) {\n      return 0;\n    }\n    return finished ? 100 : (100 * position) / duration;\n  }, [finished, position, duration]);\n\n  const remainDuration = useMemo(() => {\n    if (!duration) {\n      return '--:--';\n    }\n\n    const remain = moment.duration(finished ? 0 : duration - position);\n    const parts = [remain.minutes(), remain.seconds()];\n    if (remain.hours() > 0) {\n      parts.unshift(remain.hours());\n    }\n    return parts.map(x => String(x).padStart(2, '0')).join(':');\n  }, [finished, position, duration]);\n\n  const updatePosition = useCallback(({ position }) => {\n    setPosition(position);\n  }, []);\n\n  // 广播当前正在播放的音频\n  const notifyPlayAudio = useCallback(() => {\n    dispathAction({ type: 'switchPlayingMediaId', payload: { id: message.attachment?.id } });\n  }, [message, dispathAction]);\n\n  const notifyPauseAudio = useCallback(() => {\n    dispathAction({ type: 'switchPlayingMediaId', payload: { id: null } });\n  }, [dispathAction]);\n\n  // 音频互斥播放\n  useUpdateEffect(() => {\n    if (message.attachment.id === globalState.playingMediaId) {\n      if (playStatus !== 'PLAYING') {\n        setPlayStatus('PLAYING');\n      }\n    } else {\n      if (playStatus === 'PLAYING') {\n        setPlayStatus('PAUSED');\n      }\n    }\n  }, [message, playStatus, globalState.playingMediaId]);\n\n  // 播放下一个音频\n  useEffect(() => {\n    const playNextAudio = ({ id }) => {\n      if (id === message.attachment?.id) {\n        if (finished) {\n          setFinished(false);\n          setPosition(0);\n        }\n\n        notifyPlayAudio();\n\n        scrollIntoView(rootRef.current.parentElement, {\n          scrollMode: 'if-needed',\n          block: 'nearest',\n          inline: 'nearest',\n          behavior: 'smooth',\n        });\n      }\n    };\n\n    EE.on('replyNextPlayingMediaId', playNextAudio);\n\n    return () => {\n      EE.off('replyNextPlayingMediaId', playNextAudio);\n    };\n  }, [message, finished, notifyPlayAudio]);\n\n  // 快退\n  const doFastRewind = useCallback(() => {\n    if (progressPercent >= 100) {\n      setPosition(0);\n    } else {\n      // -10%\n      const newProgressPercent = Math.max(0, progressPercent - 10);\n      setPosition((duration * newProgressPercent) / 100);\n    }\n\n    if (finished) {\n      setFinished(false);\n    }\n    if (!globalState.playingMediaId) {\n      setPlayStatus('PLAYING');\n    }\n    notifyPlayAudio();\n  }, [finished, duration, progressPercent, notifyPlayAudio, globalState.playingMediaId]);\n\n  // 快进\n  const doFastForward = useCallback(() => {\n    if (progressPercent >= 100) {\n      setPosition(0);\n    } else {\n      // +10%\n      const newProgressPercent = Math.min(progressPercent + 10, 100);\n      setPosition(Math.min((duration * newProgressPercent) / 100, duration));\n    }\n\n    if (finished) {\n      setFinished(false);\n    }\n    if (!globalState.playingMediaId) {\n      setPlayStatus('PLAYING');\n    }\n    notifyPlayAudio();\n  }, [finished, duration, progressPercent, notifyPlayAudio, globalState.playingMediaId]);\n\n  useUpdateEffect(() => {\n    if (playStatus === 'PLAYING') {\n      if (\n        progressPercent === 0 ||\n        (bufferPercent > 0 && bufferPercent < 100 && progressPercent === bufferPercent)\n      ) {\n        setWaitBuffer(true);\n      } else {\n        setWaitBuffer(false);\n      }\n    } else {\n      setWaitBuffer(false);\n    }\n  }, [playStatus, progressPercent, bufferPercent]);\n\n  return (\n    <>\n      <Card ref={rootRef} elevation={0} className={classes.root}>\n        <div\n          className={classes.buffer}\n          style={{ width: `${Math.max(progressPercent, bufferPercent)}%` }}\n        />\n        <div className={classes.progress} style={{ width: `${progressPercent}%` }} />\n        <Typography\n          variant=\"inherit\"\n          display=\"block\"\n          noWrap\n          color=\"textSecondary\"\n          className={classes.duration}\n        >\n          {remainDuration}\n        </Typography>\n        <CardActions className={classes.action}>\n          <IconButton\n            size=\"small\"\n            onClick={() => {\n              if (playStatus === 'PLAYING') {\n                notifyPauseAudio();\n              } else {\n                if (finished) {\n                  setFinished(false);\n                  setPosition(0);\n                }\n                if (!globalState.playingMediaId) {\n                  setPlayStatus('PLAYING');\n                }\n                notifyPlayAudio();\n              }\n            }}\n          >\n            {playStatus === 'PLAYING' && (\n              <>\n                {waitBuffer && <CircularProgress size={24} color=\"secondary\" disableShrink />}\n                {!waitBuffer && <PauseIcon fontSize=\"default\" color=\"action\" />}\n              </>\n            )}\n            {playStatus !== 'PLAYING' && (\n              <>\n                {finished && <ReplayIcon fontSize=\"default\" color=\"action\" />}\n                {!finished && <PlayArrowIcon fontSize=\"default\" color=\"action\" />}\n              </>\n            )}\n          </IconButton>\n          <div />\n          <IconButton size=\"small\" onClick={doFastRewind}>\n            <FastRewindIcon fontSize=\"small\" color=\"action\" />\n          </IconButton>\n          <IconButton size=\"small\" onClick={doFastForward}>\n            <FastForwardIcon fontSize=\"small\" color=\"action\" />\n          </IconButton>\n        </CardActions>\n      </Card>\n      {playStatus === 'PLAYING' && (\n        <Sound\n          url={message.attachment?.url}\n          playStatus={playStatus}\n          autoLoad={false}\n          loop={false}\n          playbackRate={globalState.playbackRate}\n          position={position}\n          onLoading={info => {\n            setBytesLoaded(\n              Math.min(\n                (info.bytesTotal * progressPercent) / 100 + info.bytesLoaded,\n                info.bytesTotal,\n              ),\n            );\n            setBytesTotal(info.bytesTotal);\n            setDuration(info.duration);\n          }}\n          onPlaying={updatePosition}\n          onFinishedPlaying={() => {\n            setPlayStatus('STOPPED');\n            setFinished(true);\n            EE.emit('requestNextPlayingMediaId');\n          }}\n          onError={({ errorCode, description }) => {\n            console.log('error', { errorCode, description });\n          }}\n        />\n      )}\n    </>\n  );\n}\n","import { useMemo } from 'react';\nimport { marked } from '@src/lib';\nimport { renderToStaticMarkup } from 'react-dom/server.browser';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport Typography from '@material-ui/core/Typography';\nimport Link from '@material-ui/core/Link';\n\nconst useStyles = makeStyles(theme => ({\n  content: {\n    'paddingTop': '0px !important',\n    'paddingBottom': '0px !important',\n    'wordBreak': 'break-all',\n\n    '& ul': {\n      paddingLeft: 16,\n    },\n  },\n\n  link: {\n    '&:hover': {\n      'text-decoration': 'none',\n    },\n  },\n}));\n\n/**\n * @param {object} props\n * @param {MessageEntity} props.message\n */\nexport function TextCard({ message }) {\n  const classes = useStyles();\n\n  const html = useMemo(() => {\n    const renderer = new marked.Renderer();\n\n    renderer.link = (href, title, text) => {\n      return renderToStaticMarkup(\n        <Link href={href} title={title} target=\"_blank\" rel=\"noreferrer\" className={classes.link}>\n          <Typography variant=\"inherit\" display=\"inline\" color=\"error\">\n            {text}\n          </Typography>\n        </Link>,\n      );\n    };\n\n    return marked(message.text, {\n      gfm: true,\n      mangle: true,\n      renderer,\n    });\n  }, [message, classes.link]);\n\n  return (\n    <Card elevation={0}>\n      <CardContent className={classes.content}>\n        <div dangerouslySetInnerHTML={{ __html: html }} />\n      </CardContent>\n    </Card>\n  );\n}\n","import { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport CardContent from '@material-ui/core/CardContent';\nimport Grid from '@material-ui/core/Grid';\nimport Link from '@material-ui/core/Link';\nimport PictureAsPdfIcon from '@material-ui/icons/PictureAsPdf';\nimport Typography from '@material-ui/core/Typography';\nimport { prettyBytes } from '@src/lib';\n\nconst useStyles = makeStyles(() => ({\n  link: {\n    '&:hover': {\n      'text-decoration': 'none',\n    },\n  },\n}));\n\n/**\n * @param {object} props\n * @param {MessageEntity} props.message\n */\nexport function PDFCard({ message }) {\n  const classes = useStyles();\n\n  return (\n    <Card elevation={0}>\n      <CardActionArea>\n        <CardContent>\n          <Link\n            href={message.attachment?.url}\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            className={classes.link}\n          >\n            <Grid container wrap=\"nowrap\" spacing={2} alignItems=\"center\">\n              <Grid item>\n                <PictureAsPdfIcon fontSize=\"default\" color=\"error\" />\n              </Grid>\n              <Grid item xs zeroMinWidth>\n                <Typography variant=\"inherit\" display=\"block\" color=\"error\">\n                  {message.attachment?.name || `${message.attachment?.id}.pdf`}\n                </Typography>\n                <Typography variant=\"caption\" display=\"block\" noWrap color=\"textSecondary\">\n                  {prettyBytes(message.attachment?.size)}\n                </Typography>\n              </Grid>\n            </Grid>\n          </Link>\n        </CardContent>\n      </CardActionArea>\n    </Card>\n  );\n}\n","import { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport CardContent from '@material-ui/core/CardContent';\nimport Grid from '@material-ui/core/Grid';\nimport Link from '@material-ui/core/Link';\nimport OndemandVideoIcon from '@material-ui/icons/OndemandVideo';\nimport Typography from '@material-ui/core/Typography';\nimport { prettyBytes } from '@src/lib';\n\nconst useStyles = makeStyles(() => ({\n  link: {\n    '&:hover': {\n      'text-decoration': 'none',\n    },\n  },\n}));\n\n/**\n * @param {object} props\n * @param {MessageEntity} props.message\n */\nexport function VideoCard({ message }) {\n  const classes = useStyles();\n\n  return (\n    <Card elevation={0}>\n      <CardActionArea>\n        <CardContent>\n          <Link\n            href={message.attachment?.url}\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            className={classes.link}\n          >\n            <Grid container wrap=\"nowrap\" spacing={2} alignItems=\"center\">\n              <Grid item>\n                <OndemandVideoIcon fontSize=\"default\" color=\"error\" />\n              </Grid>\n              <Grid item xs zeroMinWidth>\n                <Typography variant=\"inherit\" display=\"block\" color=\"error\">\n                  {message.attachment?.name || `${message.attachment?.id}.mp4`}\n                </Typography>\n                <Typography variant=\"caption\" display=\"block\" noWrap color=\"textSecondary\">\n                  {prettyBytes(message.attachment?.size)}\n                </Typography>\n              </Grid>\n            </Grid>\n          </Link>\n        </CardContent>\n      </CardActionArea>\n    </Card>\n  );\n}\n","import { useMemo, useEffect, useCallback } from 'react';\nimport { useMount, useUnmount } from 'react-use';\nimport { soundManager } from 'soundmanager2';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Grid from '@material-ui/core/Grid';\nimport { EE } from '@src/utils';\nimport { useGlobalState } from '@src/components';\nimport { ImageCard } from './ImageCard';\nimport { AudioCard } from './AudioCard';\nimport { TextCard } from './TextCard';\nimport { PDFCard } from './PDFCard';\nimport { VideoCard } from './VideoCard';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(2),\n  },\n}));\n\n/**\n * @param {object} props\n * @param {MessageEntity[]} props.messageList\n */\nexport function MessageList({ messageList }) {\n  const classes = useStyles();\n  const [globalState, dispathAction] = useGlobalState();\n\n  useMount(() => {\n    // @see https://github.com/leoasis/react-sound\n    soundManager.setup({ ignoreMobileRestrictions: true });\n  });\n\n  useUnmount(() => {\n    dispathAction({ type: 'switchPlayingMediaId', payload: { id: null } });\n  });\n\n  const knownMessgeList = useMemo(() => {\n    return messageList.filter(x => {\n      if (['PLAIN_IMAGE', 'PLAIN_AUDIO', 'PLAIN_TEXT', 'PLAIN_VIDEO'].includes(x.category)) {\n        return true;\n      } else if (x.category === 'PLAIN_DATA') {\n        return ['application/pdf', 'audio/mp3', 'video/mp4'].includes(x.attachment?.mime_type);\n      } else {\n        return false;\n      }\n    });\n  }, [messageList]);\n\n  const audioMessageList = useMemo(() => {\n    return messageList.filter(x => {\n      return (\n        x.category === 'PLAIN_AUDIO' ||\n        (x.category === 'PLAIN_DATA' && x.attachment?.mime_type === 'audio/mp3')\n      );\n    });\n  }, [messageList]);\n\n  const replyNextPlayingMediaId = useCallback(() => {\n    const currentIndex = audioMessageList.findIndex(\n      x => x.attachment?.id === globalState.playingMediaId,\n    );\n\n    // 没有下一音频\n    if (currentIndex + 1 >= audioMessageList.length) {\n      dispathAction({ type: 'switchPlayingMediaId', payload: { id: null } });\n      return;\n    }\n\n    const nextPlayingMediaId = audioMessageList[currentIndex + 1]?.attachment?.id;\n    EE.emit('replyNextPlayingMediaId', { id: nextPlayingMediaId });\n  }, [globalState.playingMediaId, dispathAction, audioMessageList]);\n\n  useEffect(() => {\n    EE.on('requestNextPlayingMediaId', replyNextPlayingMediaId);\n\n    return () => {\n      EE.off('requestNextPlayingMediaId', replyNextPlayingMediaId);\n    };\n  }, [replyNextPlayingMediaId]);\n\n  return (\n    <Grid container spacing={1} className={classes.root}>\n      {knownMessgeList.map(message => (\n        <Grid key={message.message_id} item xs={12} sm={12}>\n          {message.category === 'PLAIN_IMAGE' && <ImageCard message={message} />}\n          {message.category === 'PLAIN_AUDIO' && <AudioCard message={message} />}\n          {message.category === 'PLAIN_TEXT' && <TextCard message={message} />}\n          {message.category === 'PLAIN_VIDEO' && <VideoCard message={message} />}\n          {message.category === 'PLAIN_DATA' && (\n            <>\n              {message.attachment.mime_type === 'application/pdf' && <PDFCard message={message} />}\n              {message.attachment.mime_type === 'audio/mp3' && <AudioCard message={message} />}\n              {message.attachment.mime_type === 'video/mp4' && <VideoCard message={message} />}\n            </>\n          )}\n        </Grid>\n      ))}\n    </Grid>\n  );\n}\n","import { useState, useCallback, useRef, useMemo } from 'react';\nimport { useMount } from 'react-use';\nimport { Redirect, useParams } from 'react-router-dom';\nimport Container from '@material-ui/core/Container';\nimport Divider from '@material-ui/core/Divider';\nimport { DEFAULT_TITLE } from '@src/configs/env';\nimport { courseCollection } from '@src/configs/course';\nimport { delay, decrypt } from '@src/lib';\nimport { useDocumentTitle } from '@src/hooks';\nimport { TitleBar, Loading } from '@src/components';\nimport { MessageHeading } from './MessageHeading';\nimport { MessageList } from './MessageList';\n\nconst { entities: courseEntities } = courseCollection;\n\nexport function DetailPage() {\n  // @ts-ignore\n  const { courseId: encryptedId } = useParams();\n  const courseId = useMemo(() => decrypt(encryptedId), [encryptedId]);\n\n  const tryCountRef = useRef(0);\n  const [fetchStatus, setFetchStatus] = useState(/** @type {LoadingState} */ ('none'));\n  const [messageList, setMessageList] = useState(/** @type {MessageEntity[]} */ ([]));\n\n  const fetchMessageList = useCallback(async () => {\n    try {\n      if (!courseEntities[courseId]) {\n        setFetchStatus('failed');\n        return;\n      }\n\n      setFetchStatus('loading');\n      tryCountRef.current += 1;\n      const { default: messageList } = await import(`@src/data/courses/${courseId}.json`);\n\n      setMessageList(messageList);\n      setFetchStatus('loaded');\n    } catch (err) {\n      if (tryCountRef.current >= 10) {\n        setFetchStatus('failed');\n      } else {\n        await delay(200);\n        fetchMessageList();\n      }\n    }\n  }, [courseId]);\n\n  useDocumentTitle([courseEntities[courseId]?.title, DEFAULT_TITLE].filter(Boolean).join(' - '));\n  useMount(fetchMessageList);\n\n  if (fetchStatus === 'failed') {\n    return <Redirect to=\"/\" />;\n  }\n\n  return (\n    <>\n      <TitleBar title={DEFAULT_TITLE} course={courseEntities[courseId]} back />\n      <Container maxWidth=\"sm\">\n        {fetchStatus === 'loading' && <Loading />}\n        {fetchStatus === 'loaded' && (\n          <>\n            {Boolean(courseEntities[courseId]) && (\n              <MessageHeading course={courseEntities[courseId]} />\n            )}\n            <Divider />\n            <MessageList messageList={messageList} />\n          </>\n        )}\n      </Container>\n    </>\n  );\n}\n","import { useMemo } from 'react';\nimport { HashRouter as Router, Switch, Route, Redirect } from 'react-router-dom';\nimport { ThemeProvider, createMuiTheme } from '@material-ui/core/styles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { useTheme } from '@src/hooks';\nimport { GlobalStateProvider } from '@src/components';\nimport { IndexPage } from './routes/index';\nimport { DetailPage } from './routes/detail';\n\nfunction App() {\n  const { theme: themeConfig } = useTheme();\n  const theme = useMemo(() => createMuiTheme(themeConfig), [themeConfig]);\n\n  return (\n    <GlobalStateProvider>\n      <ThemeProvider theme={theme}>\n        <CssBaseline />\n        <Router>\n          <Switch>\n            <Route strict exact path=\"/\">\n              <IndexPage />\n            </Route>\n            <Route strict exact path=\"/courses/:courseId\">\n              <DetailPage />\n            </Route>\n            <Redirect to=\"/\" />\n          </Switch>\n        </Router>\n      </ThemeProvider>\n    </GlobalStateProvider>\n  );\n}\n\nexport { App };\n","import { useCallback, useState, useEffect } from 'react';\nimport { EE, localStore } from '@src/utils';\nimport { THEME_TYPE_STORED_KEY, getThemeConfig } from '@src/configs/theme';\n\nexport function useTheme() {\n  const [theme, setTheme] = useState(() => {\n    // get initial theme type\n    let type = localStore.get(THEME_TYPE_STORED_KEY);\n    if (!['light', 'dark'].includes(type)) {\n      type = 'light';\n    }\n\n    return getThemeConfig(type);\n  });\n\n  const toggleTheme = useCallback(() => {\n    const { type } = theme.palette;\n    const nextType = type === 'light' ? 'dark' : 'light';\n\n    // switch theme type\n    setTheme(getThemeConfig(nextType));\n\n    // remeber theme type\n    localStore.set(THEME_TYPE_STORED_KEY, nextType);\n  }, [theme, setTheme]);\n\n  useEffect(() => {\n    EE.on('toggle-theme', toggleTheme);\n    return () => EE.off('toggle-theme', toggleTheme);\n  }, [toggleTheme]);\n\n  return { theme, toggleTheme };\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}